{% extends 'base.html' %}

{% block title %}Traffic — Ruaa Smart City{% endblock %}

{% block content %}
<div class="app-wrapper">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="sidebar-logo">
        <i class="fas fa-city"></i>
      </div>
      <div class="sidebar-brand">
        <h1>Ruaa</h1>
        <p>Smart City</p>
      </div>
    </div>

    <nav class="sidebar-nav">
      <div class="nav-section">
        <a href="{% url 'dashboard' %}" class="nav-link">
          <i class="fas fa-home"></i>
          <span>Dashboard</span>
        </a>
        <a href="{% url 'traffic' %}" class="nav-link active">
          <i class="fas fa-car"></i>
          <span>Traffic</span>
        </a>
        <a href="{% url 'weather' %}" class="nav-link">
          <i class="fas fa-cloud-sun"></i>
          <span>Weather</span>
        </a>
        <a href="{% url 'services' %}" class="nav-link">
          <i class="fas fa-hospital"></i>
          <span>Services</span>
        </a>
        <a href="{% url 'map' %}" class="nav-link">
          <i class="fas fa-map"></i>
          <span>City Map</span>
        </a>
      </div>
    </nav>

    <div class="sidebar-footer">
      <div class="user-profile">
        <div class="user-avatar">
          <i class="fas fa-user"></i>
        </div>
        <div class="user-info">
          <div class="user-name">{{ user.username }}</div>
          <div class="user-role">Citizen</div>
        </div>
        <form method="post" action="{% url 'logout' %}" style="margin: 0;">
          {% csrf_token %}
          <button type="submit" class="logout-btn" title="Logout">
            <i class="fas fa-sign-out-alt"></i>
          </button>
        </form>
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Top Bar -->
    <div class="top-bar">
      <div class="page-title">
        <h2>Live Traffic Status</h2>
        <p>Real-time traffic conditions across the city</p>
      </div>
    </div>

    <!-- Content Area -->
    <div class="content-area">
      <!-- Stats Grid -->
      <div class="stats-grid">
        {% for road, info in traffic_data.items %}
        <div class="stat-card 
          {% if info.color == 'success' %}stat-success
          {% elif info.color == 'warning' %}stat-warning
          {% else %}stat-danger{% endif %}">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="fas fa-car"></i>
            </div>
            <span class="badge 
              {% if info.color == 'success' %}badge-success
              {% elif info.color == 'warning' %}badge-warning
              {% else %}badge-danger{% endif %}">
              {{ info.status }}
            </span>
          </div>
          <div class="stat-content">
            <h3>{{ road }}</h3>
            <p class="text-muted">Main Route</p>
          </div>
        </div>
        {% endfor %}
      </div>

      <!-- Legend Card -->
      <div class="card mt-4">
        <div class="card-header">
          <h3><i class="fas fa-info-circle me-2"></i>Traffic Legend</h3>
        </div>
        <div class="card-body">
          <div class="legend-grid">
            <div class="legend-item">
              <span class="legend-dot legend-success"></span>
              <span><strong>Clear</strong> — Normal traffic flow</span>
            </div>
            <div class="legend-item">
              <span class="legend-dot legend-warning"></span>
              <span><strong>Moderate</strong> — Some congestion</span>
            </div>
            <div class="legend-item">
              <span class="legend-dot legend-danger"></span>
              <span><strong>Heavy</strong> — Significant delays</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
